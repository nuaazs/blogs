# Real-Time Scatter Estimation for Medical CT using the Deep Scatter Estimation (DSE): Method and Robustness Analysis with Respect to Different Anatomies, Dose Levels, Tube Voltages and Data Truncation

使用深度散射估计 (DSE) 对医学 CT 进行实时散射估计：针对不同解剖结构、剂量水平、管电压和数据截断的方法和稳健性分析

## 概述

### 目的

X 射线散射导致 CT 图像对比度降低、CT 值不准确以及条纹和杯状伪影。因此，散射校正对于保持 CT 和 CBCT 检查的诊断价值至关重要。然而，现有的方法无法将两者结合起来：高精度和高计算性能。因此，我们提出了深度散射估计 (DSE)：一种深度卷积神经网络，用于实时导出高度准确的散射估计。



### 方法

黄金标准散射估计方法依赖于专用的蒙特卡罗 (MC) 光子传输代码。然而，由于计算成本高，MC 方法不能常规使用。为了以类似的精度实现实时散射校正，DSE 使用了一个深度卷积神经网络，该网络经过训练可以根据获取的投影数据预测 MC 散射估计。在这里，使用 CBCT 头部、胸部和腹部扫描的模拟以及实验性桌面 CBCT 的测量来证明 DSE 的潜力。两种传统的计算有效的散射估计方法被实现为参考：基于内核的散射估计 (KSE) 和混合散射估计 (HSE)。



### 结果

模拟研究表明，DSE 可以很好地泛化到变化的管电压、变化的噪声水平以及变化的解剖区域，只要它们在训练数据中得到适当的表示。在任何情况下，散布估计与地面实况 MC 散布分布的偏差都小于 1.8%，而 HSE 的偏差介于 6.2% 和 293.3% 之间，KSE 的偏差介于 11.2% 和 20.5% 之间。为了评估真实数据的性能，进行了拟人头部模型的测量。通过与狭缝扫描重建的比较来量化误差。这里，偏差分别为 278 HU（无校正）、123 HU（KSE）、65 HU（HSE）和 6 HU（DSE）。



### 结论

DSE 在准确性方面明显优于传统的散射估计方法。 DSE 几乎与 Monte Carlo 模拟一样准确，但在速度（≈ 10 ms / 投影）方面要好几个数量级。



## 介绍

CT 图像重建算法依赖于这样一个假设，即检测到的 X 射线不会在扫描对象内发生任何相互作用。散射 X 射线对采集的投影数据的贡献导致违反该假设。结果，相应的 CT 图像对比度降低、CT 值不准确以及杯状和条纹伪影1-3。特别是在锥束 CT (CBCT) 中，散射与原色的比率很容易达到 1 或更高的数量级，散射伪影是一个严重的问题。因此，适当的散射校正对于保持 CT 检查的诊断价值至关重要。

基本上，有两个不同的概念来处理 CT 中的 X 射线散射：散射抑制和散射估计。散射抑制旨在使用防散射栅或准直器 4 减少到达检测器的散射 X 射线的数量。散射估计方法是本手稿的重点，它试图推导出散射 x 射线分布的估计值，随后用于校正采集的投影数据 5。在这里，散射分布可以使用专用硬件（如光束阻挡器或主调制网格）6-13 或使用基于物理、经验或一致性模型来预测 X 射线散射的基于软件的方法来估计 14-28

在这些方法中，黄金标准是执行精确建模整个 CT 采集过程的蒙特卡罗 (MC) 模拟。然而，虽然非常准确，但 MC 模拟有两个主要缺点：阻止实时应用的高计算复杂性，以及需要关于要模拟的对象的准确先验信息，例如密度分布和材料分布 29。

因此，所谓的基于内核的散射估计方法在实践中是首选的 。这些方法可以分为基于模型的方法和基于 MC 的方法。前者将 x 射线散射近似为散射源项的积分变换，散射源项反映了沿射线从源到检测器的散射量，而散射传播内核则解释了散射 x 射线的空间扩散。通常，这两个术语都是使用简化的理论模型（例如，仅考虑单次散射）推导出来的，其中包含一组经过校准以适合 MC 模拟或参考测量的开放参数。相比之下，基于 MC 的方法利用预先计算的针束 MC 模拟原始几何形状，例如具有不同尺寸的长方体和椭球体。为了估计测量投影内的散射，根据适当的相似性度量将预先计算的针束内核之一分配给每个探测器像素。最后，将所有内核相加，包括说明先前物体形状和实际患者形状之间差异的校正项。

虽然具有实时能力，但与 MC 模拟相比，基于内核的方法具有精度降低的缺点。此外，分别找到适用于不同解剖区域、视角或采集条件的参数或校正项可能具有挑战性

深度神经网络有可能克服这些缺点，并已在 CT 成像的多个领域证明了出色的性能，例如分割 33-36、配准 37、去噪 38-42、CT 伪影减少 43-45 或稀疏视图 CT

因此，我们最近提出了用于医疗 CT50,51 和工业 CT52 的深度散射估计 (DSE)。为了估计散射，DSE 使用一个深度卷积神经网络，该网络经过训练以再现 MC 模拟的输出，仅将获取的投影数据的函数作为输入。一旦 DSE 网络学习了相应的映射，就可以实时生成与 MC 模拟精度几乎相似的散点估计。与之前的出版物相比，这份手稿提供了额外的实验，研究 DSE 方面的最适合神经网络学习的映射、不同管电压的泛化、不同噪声水平的泛化、不同解剖区域的泛化以及DSE 在截断数据中的应用。此外，我们展示了 DSE 在实验 CBCT 系统的测量数据中的应用。对于任何实验，将 DSE 与两种常用的传统散射估计方法进行比较：基于内核的和混合散射估计



## 材料与方法

### 基于核的散点估计Kernel-Based Scatter Estimation

基于内核的散射估计 (KSE) 方法通常通过散射源项 T(p) 和散射传播内核G的积分变换来导出散射估计 Sest
$$
S _ { \operatorname { s e t } ( u ) } = \int T ( v ) ( u ^ { \prime } ) G ( u , u ^ { \prime } , c ) d u ^ { \prime }
$$


在固定核的情况下，可以表示为卷积运算$G ( u , u ^ { \prime } , c ) = G ( u - u ^ { \prime } , c )$





### 深度散射估计 (DSE)

